# Recap - 2026-01-07

- Removed `initializeCommand` and `postStopCommand` from `devcontainer.json` and moved `CONTAINER_*` values into `containerEnv`.
- Added an entrypoint script that traps shutdown signals and emits the post-stop message.
- Inlined the post-stop message into the entrypoint and deleted `post-stop.sh`.
- Fixed the Dockerfile copy path for the entrypoint to match the build context.
- Updated `.env.example` to avoid quotes and shell expansions that do not work with Docker `--env-file`.
- Removed `--env-file` from `.devcontainer/devcontainer.json` to rely on launch scripts/localEnv expansion.
- Updated `.env.example` notes to reflect scripts/localEnv as the source of truth for expansion.
- Fixed `.devcontainer/scripts/colors.sh` to use raw ANSI escapes (no prompt-only `\[ \]`) so printf output renders correctly.
- Hardened `claude-launch.sh` path resolution with `cd --`/`dirname --` to handle edge-case paths.
- Hardened `devcontainer-launch.sh` path resolution and made container naming derive from `PROJECT_NAME`.
- Hardened `editor-launch.sh` path resolution with `cd --`/`dirname --`.
- Added `ca-certificates` and `DEBIAN_FRONTEND=noninteractive` to `.devcontainer/Dockerfile` package install.
- Updated `.devcontainer/devcontainer.json` to use `PROJECT_NAME`, `WORKSPACE_FOLDER`, and an explicit `image` tag; documented `WORKSPACE_FOLDER` in `.env.example`.
- Updated `.devcontainer/scripts/verify-git-ssh.sh` to require a git host argument or `GIT_SSH_HOST`.
- Updated `.devcontainer/scripts/ssh-agent-setup.sh` to safely return or exit when already initialized.
- Added `SSH_AUTH_SOCK` fail-fast check and a VS Code shell integration guard to `.devcontainer/scripts/post-create.sh`.
- Hardened `.devcontainer/scripts/env-loader.sh` to require a workspace, preserve `SSH_AUTH_SOCK`, and improve debug output.
- Added `set +u` to `.devcontainer/scripts/bash-prompt.sh` to avoid nounset issues in interactive shells.
- Added `WORKSPACE_FOLDER=/workspace` to `.env` to satisfy the updated env-loader requirements.
- Removed quotes from `.env` values to keep shell-sourced expansion behavior consistent.
- Restored quotes for `GIT_USER_NAME` in `.env` to handle the space-separated value.
- Updated launch scripts to fall back to `docker stop` when `devcontainer down` is unavailable.
- Removed the unsupported `image` property from `.devcontainer/devcontainer.json` and tagged builds via `devcontainer build --image-name` in launch scripts.
- Added `--id-label` isolation for CLI and Claude launchers so they can run in separate containers from the editor.
- `devcontainer-launch.sh` now sets `SKIP_CLAUDE_INSTALL=1` via `--remote-env` to skip Claude install for CLI sessions only.
- Reverted editor-stop-on-exit changes; editor sessions now leave the container running as default.
